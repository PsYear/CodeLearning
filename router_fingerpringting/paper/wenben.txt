前言
	由于无线路由得普及，各类网络的接入都通过无线路由器，因此从接入网络的用户来看，比较容易接入伪造的路由设备，从而将自己的网络流量暴露在不安全的网络环境之下，而对于设备的一些普通的验证方式，如mac地址、设备名称、（无线路由通道）等都容易伪造成同被伪造的路由一样的信息。所以，在客户机端对目标路由进行判断是否是伪造的路由设备不能光借助先前这些不安全并且较为容易仿造的信息，需要有新手段来检测路由设备的真伪，对于路由协议的流量包进行指纹比对和识别，以此来避免信息伪造的可能性，减少用户流量信息被窃取的情形。



研究的问题是
	通过相关协议特征提取路由器的指纹特征，分析分类

研究方法
	【被动收包+主动抓包】包抓取+分类器


相关路由器的协议分析
	观察一段时间内的路由器和主机间收发的数据包，可以发现其网络协议主要为ICMP\ARP\SSDP\ARP
	[wiki]【要不要更详细一点？】
	1.DNS（domain name system）是用来将域名和ip地址相互映射能使人更方便地访问互联网。在主机进行互联网访问时，局域网内路由器会对近期访问的域名进行缓存，因此主机和路由器之间会收发大量dns包，本文的实验中使用python的网络编程来控制数据包在主机和测试路由器之间的收发状况，其运作原理是向路由器请求域名的ip映射，并接收路由器的返回数据包。
	2.Icmp（Internet Control Message Protocal）是用来返回错误信息和分析路由的。很多常用的工具基于icmp消息，本文的实验中使用的ping来控制数据包在主机和测试路由器之间收发状况，其运作原理是向目标主机传出一个ICMP id字段中为“echo request”的类别代码，并接收id字段中为“echo reply”的类别代码。
	3.Arp(Address Resolution Protocol)是用来透过目标设备的IP地址。查询目标设备的MAC地址，以保证通信的顺利进行。本文的实验采用python的网络编程来控制数据包在主机和测试路由器之间的收发状况，其运作原理是在局域网中发送arp request来询问路由器ip的mac地址，并接收arp response获取路由器设备的mac地址。
	4.ssdp(simple service discovery protocol)是用来提供局域网内发现设备的机制，控制点（也就是接受服务的客户端）可以通过使用简单服务发现协议，根据自己的需要查询在自己所在的局部网络里面提供特定服务的设备。设备（也就是提供服务的服务器端）也可以通过使用简单服务发现协议，向自己所在的局部网络里面的控制点宣告它的存在。 本实验采用被动接收的方式通过wireshark来抓取数据包在主机和测试路由器之间的收发状况。




数据采集
	【dns协议要确定是由路由器上的缓存进行数据包的收发】
	Ubuntu系统下使用python的网络编程方法对于不同协议的协议内容发包，并采用tcpdump进行流量监听记录流量帧的信息。对于dns协议，预先选取200条网址做为域名请求，返回ip地址，在清除计算机主机上的dns缓存后，在socket库中使用获取地址信息的函数请求向路由器发送dns域名请求包，监听路由器的返回包，提取相关流量帧的特征。对于icmp协议，使用shell中的ping方法，以路由器在子网内的地址做为ping目标发送1500条ping请求，并监听路由器的返回信息，提取流量帧的特征。对于arp协议先获取路由器和监听主机的ip地址使用python中scapy库，向路由器发送2000条arp请求，监听路由器的返回包并提取相关的流量帧的特征。对于ssdp协议，采用被动收取的方法，在主机接入路由器后，监听upd的1900端口。

协议蕴含的参数
	对于各个协议的数据包而言，由于其在路由器和主机之间的收发过程较为相似，因此除其报文格式有着比较大得差异外，很多参数的定义都是极为相似。而报文格式和内容又由于会产生伪造信息或者被加密等原因，分析这些内容反而会被误导，而一些由物理设备产生的参数，反而具有难以伪造以及较易获取的原因，对于设备指纹的识别有着很强的适用性。一些普遍采用的非内容性协议参数有:
	(1)帧大小(frame size):帧大小表示的是数据报文所包含字节的长度，对于这四个协议而言，arp协议和icmp协议的帧大小固定，而dns协议的帧大小的差异主要体现在请求域名的长度，所以从这三个协议来看，它们的帧长度和路由器无关，而ssdp协议的帧大小主要体现在usn头的长度差异，usn头是表示不同服务的统一服务名，提供了标识出相同类型服务的能力。从实验的数据包抓取来看，不同厂商的路由器所发送的ssdp数据帧其usn服务类型的顺序设置和选择有不同，因此可以通过ssdp数据帧的长度来直接对路由器厂商进行区分。
	(2)传输率（transmission rate）：数据帧的传输率表示的是数据帧在单位时间内所传输的数据帧个数，这个参数主要由路由器网卡的特性所决定，因此对于各个协议而言，帧的传输率可以有效的区分不同路由设备。
	(3)传输时间(transmission time)：数据帧的传输时间是
	(4)间隔到达时间(inter-arrival time)
	(5)传输偏移(transmission skewing)


	五个主要的分析
	Ssdp单独分析

协议数据帧的实际分布特性










